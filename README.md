# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Документация
Архитектура приложения соответствует мобели MVP (Model - View - Presenter)
Model - слой [Класс] для хранения данных
View - слой [Класс] для работы с отображением / разметкой на странице
Presenter [EventEmitter] - слой, связывающий первые два слоя Model и View

**Component**
Это базоввый класс, от которого будут наследоваться [extends] другие классы, необходимые для работы с разметкой (для слоя View).
Данный класс в конструкторе принимает HTML-элемент, с которым будет идти работа.
container: HTMLElement: Это элемент DOM, который будет использоваться как контейнер для компонента. Здесь будет происходить работа непосредственного с элементом.
У этого класса будут следующие методы:
1. toggleClass(element: HTMLElement, className: string, force?: boolean) - Переключить класс на элементе. Данный метод принимает в качестве параметров элемент, название класса и необязательный параметр force
2. setText(element: HTMLElement, value: unknown) - Установить текстовое содержимое внутри элемента. Принимает элемент и значение текстового содержимого
3. setDisabled(element: HTMLElement, state: boolean) - Изменение статуса блокировки элемента. Принимает элемент и значение true или false
4. setHidden(element: HTMLElement) - Скрыть элемент со странице. Принимает элемент
5. setVisible(element: HTMLElement) - Показать элемент. Принимает элемент
6. setImage(element: HTMLImageElement, src: string, alt?: string) - Установить изображение с алтернативным текстом. Принимает элемент, значение src для картинки и неоьязательный параметр alt-альтернативный текст
render(data?: Partial): HTMLElement - Вернуть корневой элемент, который принимает конструктор. Принимает необзательный параметр data, с набором значений

**Класс EventEmiter - Презентер**
Это класс - брокер событий всего приложения.
Базовый класс, центральный брокер событий, данный класс позволяет подписываться на события и реагировать на них. 
Конструктор данного класса будет принимать объект типа Map, где ключом будет строка или регулярное выражение, а значением будет Функция 
1. on(eventName: EventName, callback: (event: T) => void) - установить обработчик на событие. Данный метод принимает параметрами название события в виде строки и функцию, которая будет выполняться
off(eventName: EventName, callback: Subscriber) - снять обработчик с события. Данный метод принимает название события в виде строки и функцию
emit(eventName: string, data?: T) - инициировать событие с данными.Данный метод принимает в качестве параметров строку - название события и необязательный параметр данных
onAll(callback: (event: EmitterEvent) => void) - слушать все события. Данный метод принимает функцию
offAll() - сбросить все обработчики. Не принимает никаких параметров
trigger(eventName: string, context?: Partial) - сделать коллбек триггер, генерирующий событие при вызове.

1. событие cards:set - Отрисовка на главной странице всех карточек, после того как они пришли с сервера
2. card:open - открыть Превью-товара после клика на карточку товара
3. peview:toggle - Переключение внутри карточки Превью состояния кнопки - Добавить в корзину / Удалить из корзины
4. modal:open - Блокируем прокрутку страницы при открытии модального окна
5. modal:close - Разблокируем прокрутку страницы после закрытия модального окна
6. basket:open - Открыть корзину с товарами
7. basket:update - обновить корзину с товарами
8. order:open - открыть формы Order со способами оплаты и адресом
9. orderInput:change - событие при изменение полей в форме Order и Contacts
10. orderFormErrors:change - событие при изменении ошибок внутри форма Order
11. contactsFormErrors:change - событие при изменении ошибок внутри форма Contacts
12. order:submit - Закрытие формы Order и отрисовка на ее месте формы Contacts
13. contacts:submit - отправка заказа на сервер, отрисовка на месте формы Contacts окна об успешной отправке формы
14. order:success - отрисовка на странице окна об успешной отправке формы
15. payment:toggle - переключение обводки между кнопками Онлайн при получении



**Класс Api**
Это класс для работы с внешними данными и сервером.
    1. readonly baseUrl: string - Базовый URL для запроса. Тип - строка
    2. protected options: RequestInit - Объект, с набором опций для fetch-запроса
    3. protected async handleResponse(response: Response): Promise<Partial<object>> - функция, принимающая запрос и возвращающая результат работы Промиса или ошибку 
    4. async get(uri: string) - Функция для отправки get-запроса. Принимает параметром строку - uri
    5. post(uri: string, data: object) - Функция для отправки post-запроса. Принимает параметром строку-uri, объект с данными, необязательный параметр, который говорит какой именно запрос будет. Если параметро не указан, то Post-запрос, во всех оставшихся случаях - Put, Delete.
    6. Конструктор класса принимает параметром baseUrl и options из п.1 и 2.


**View - классы представления**

Класс **Card** - базовый класс для всевозможных карточек, которые есть в приложении
1. Наследуется от Component
2. Содержит поля _title - поле для заголовка, _price - поле для цены
3. Принимает в конструкторе blockname - название блока и container - html элемент
4. Содержит соответствующие сеттеры title - для установки заголовка, price  для установки цена

Класс **CardItem** - класс для работы c карточками товаров на главной странице, которые приходят с сервера
1. Наследуется от Card
2. Содержит поля _img - поле для изображения, _category - поле для категории, _id - поле для id
3. Принимает в конструкторе blockname - название блока и container - html элемент, actions - необязательный объект экшенов с событиями
4. Содержит соответствующие сеттеры img - установить изображение, category - установить категорию, id - установить id

Класс **CardItemPreview** - класс для работы c карточками товаров на главной странице, которые приходят с сервера
1. Наследуется от Card
2. Содержит поля _img - поле для изображения, _category - поле для категории, _description - поле для описания, _buttonBasket - кнопка, _selected - поле, показывающее выбрал ли товар в корзине.
3. Принимает в конструкторе blockname - название блока и container - html элемент, actions - необязательный объект экшенов с событиями
4. Содержит соответствующие сеттеры img - установить изображение, category - установить категорию, description - установить описание, price - установить цену, selected - установить текст внутри кнопки _buttonBasket

Класс **CardItemBasket** - класс для работы c карточками товаров в корзине
1. Наследуется от Card
2. Содержит поля _index - порядковый номер товара в корзине, _buttonDelete - кнопку с иконкой удаления товара из корзины
3. Принимает в конструкторе blockname - название блока, container - html элемент, actions - необязательный объект экшенов с событиями
4. Содержит соответствующие сеттер index - установить порядковый номер товара в корзине

Класса **Form** - класс для работы с формами
1. Наследуется от Component
2. Содержит поля _submit - кнопка отправки формы, _errors - элемент для вывода ошибок на страницу
3. Принимает в конструкторе container - html элемент, events - экземпляр класса Event Emitter
4. Содержит соответствующие сеттеры valid - отвечает за блокировку кнопки отправки формы, errors - устанавливает текст ошибок рядом с кнопкой
5. Содержит методы onInputChange - данное событие срабатывает при изменение теста внутри полях input формы

Класс **Order** - класс для работы с формой Order
1. Наследуется от Form
2. Содержит поля _cardButton -кнопка оплаты Картой, _cashButton - кнопка оплаты Наличными при получении
3. Принимает в конструкторе container - html элемент, events - экземпляр класса Event Emitter
4. Содержит метод disabledButtons - сбрасывает обводку и весь текст внутри элементов формы после оформления заказа

Класс **Contacts** - класс для работы с формой Contacts
1. Наследуется от Form
2. Содержит поля _cardButton, _cashButton
3. Принимает в конструкторе container - html элемент, events - экземпляр класса Event Emitter, 
4. Содержит метод resetInputs - сбрасывает текст внутри элементов формы после оформления заказа


Класс **Basket** - класс для работы с корзиной
1. Наследуется от Component
2. Содержит поля _list - для отображения списка товаров, _total - для отображения суммы заказа, _button - кнопка оформления заказа
3. Принимает в конструкторе container - html элемент, events - экземпляр класса Event Emitter, 
4. Содержит соответствующие сеттеры items - для отображения информации о том пустая ли корзина или нет, total - для отображения суммы всех покупок

Класс **Modal** - класс для работы с модальными окнами
1. Наследуется от Component
2. Содержит поля _closeButton - кнопка закрытия модального окна, _content - содержание модального окна
3. Принимает в конструкторе container - html элемент, events - экземпляр класса Event Emitter, 
4. Содержит сеттер content - устанавливает внутри себя контент - корзина, окно Превью и т.д.
5. Содержим методы open - открыть модальное окно, close - закрыть модальное окно, render - вызвать метод render у родительского класса, открыть модальное окно. ДАнный метод возвращает корневой элемент


Класс **Page** - класс для работы с главной странице приложения
1. Наследуется от Component
2. Содержит поля _counter - количество товаро в корзине, _catalog - список товаро с сервера, _wrapper - обертка страницы, _basket - иконка корзины, внутри которой отображается количество товаров в корзине
3. Принимает в конструкторе container - html элемент, events - экземпляр класса Event Emitter, 
4. Содержит сеттеры counter - устанавливает количество товаров в корзине, catalog - место для отрисовки всех товаров с сервера, locked - добавление или удаление класса css, отвечающего за блокировку страницы


Класс **Success** - Класс для работы с отображение об успешной отправки заказа на сервер
1. Наследуется от Component
2. Содержит поля _close - кнопка внутри окна, которая позволяет закрыть окно, _total - поле с общей суммой покупок
3. Принимает в конструкторе container - html элемент, actions - необязательный объект экшенов с событиями 
4. Содержит соответствующие сеттеры total - показывает количество списанных денег


**Класс Model - модель данных**
Класс Model - содержит следующие поля и методы:
1. Конструктор данного класса принимает свойства events - экзепляр класса Event Emitter
2. Поля данного класса является cards - список товаров с сервера, basketItems - список товаров в корзине, данные пользователя - order: способ оплаты, адрес, email, номер телефона
3. Метод setCards. Данный метод принимает параметром массив карточек товаров и вызывает событие cards:set - отрисовка на главной странице
4. getCard - Метод не принимает параметров. Возвращает массив карточек с сервера
5. checkInBasket - Метод для проверки того, если ли карточка в корзине. Возвращает true или false
6. updateBasket - Метод принимает параметром карточку товара и обновляет корзину
7. getBasketCount - Метод возвращает количество товаров в корзине. Параметров не принимает
8. getBasketItems - Метод возвращает массив товаро в корзине. Параметров не принимает
9. getBasketTotal - Метод возвращает сумму товаров в корзине. Параметров не принимает
10. getItemsBasketForOrder - Метод возваращает id всех товаров в корзине для оформления заказа. Параметров не принимает
11. clearBasket - Метод очищает корзину. Параметров не принимает
12. clearOrder - Метод очищает данные пользователя. Параметро не принимает
13. setOrderField - Метод устаналивает данные пользователя в соответствующие поля
14. validateContacts - Метод для валидации полей формы Contacts
15. validateOrder - Метод для валидации полей формы Order